# frontend/.goreleaser.yaml
version: 2
project_name: shisha-tracker-nextgen-frontend

builds: []                 # keine Go-Binaries
dist: dist-release

before:
  hooks:
    - npm ci
    - npm run build

archives:
  - id: frontend-dist
    meta: true
    formats: ["zip"]       # oder ["tar.gz"]
    name_template: "{{ .ProjectName }}_{{ .Version }}"
    files:
      - dist/**/*
    wrap_in_directory: true

# Neue Docker-API (entkoppelt von Go-Builds)
dockers_v2:
  - images:
      - ghcr.io/str33tr4z0r/shisha-tracker-nextgen-frontend
    tags:
      - "{{ .Version }}"
      - "{{ if not .IsSnapshot }}latest{{ end }}"
    platforms:
      - linux/amd64
    dockerfile: Frontend.goreleaser
    labels:
      org.opencontainers.image.title: "{{ .ProjectName }}"
      org.opencontainers.image.version: "{{ .Version }}"
      org.opencontainers.image.created: "{{ .Date }}"
      org.opencontainers.image.revision: "{{ .FullCommit }}"
      org.opencontainers.image.source: "https://github.com/str33tr4z0r/shisha-tracker-nextgen"
    build_flags:
      - "--pull"

changelog:
  sort: asc
  filters:
    exclude:
      - "^docs:"
      - "^test:"