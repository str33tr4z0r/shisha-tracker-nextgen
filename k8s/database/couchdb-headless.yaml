# Headless Service für stabile Hostnames (z. B. couchdb-0.couchdb-headless.<ns>.svc.cluster.local)
# Erweiterte Ports inklusive Erlang/EPMD, damit NetworkPolicies/Service-Endpunkte
# alle für die CouchDB-Verteilung nötigen Ports abdecken.
apiVersion: v1
kind: Service
metadata:
  name: couchdb-headless
  namespace: shisha
  labels:
    app: couchdb
spec:
  clusterIP: None
  publishNotReadyAddresses: true
  selector:
    app: couchdb
  ports:
    - name: http
      port: 5984
      targetPort: 5984
      protocol: TCP
    - name: epmd
      port: 4369
      targetPort: 4369
      protocol: TCP
    - name: erlang-9100
      port: 9100
      targetPort: 9100
      protocol: TCP
    - name: erlang-9101
      port: 9101
      targetPort: 9101
      protocol: TCP
    - name: erlang-9102
      port: 9102
      targetPort: 9102
      protocol: TCP
    - name: erlang-9103
      port: 9103
      targetPort: 9103
      protocol: TCP
    - name: erlang-9104
      port: 9104
      targetPort: 9104
      protocol: TCP
    - name: erlang-9105
      port: 9105
      targetPort: 9105
      protocol: TCP